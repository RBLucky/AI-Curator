{% extends "base.html" %}
{% block title %}{{ tool.name }} - AI Curator{% endblock %}
{% block content %}

<!-- Hero Section -->
<section style="padding: 2rem 0; position: relative;">
    <!-- Floating background elements -->
    <div style="position: absolute; top: 20%; left: 10%; width: 200px; height: 200px; background: radial-gradient(circle, rgba(191, 0, 255, 0.2), transparent); border-radius: 50%; filter: blur(60px); animation: float 20s ease-in-out infinite;"></div>
    <div style="position: absolute; top: 40%; right: 15%; width: 150px; height: 150px; background: radial-gradient(circle, rgba(0, 212, 255, 0.2), transparent); border-radius: 50%; filter: blur(50px); animation: float 25s ease-in-out infinite reverse;"></div>
    
    <!-- Breadcrumb Navigation -->
    <div style="margin-bottom: 2rem;">
        <nav class="breadcrumb">
            <a href="{% url 'home' %}">üè† Home</a>
            <span class="breadcrumb-sep">‚Üí</span>
            <a href="{% url 'curator_app:tool_list' %}">üõ†Ô∏è Tools</a>
            <span class="breadcrumb-sep">‚Üí</span>
            <span class="breadcrumb-current">{{ tool.name }}</span>
        </nav>
    </div>

    <!-- Tool Header -->
    <div class="tool-hero">
        <div class="tool-hero-content">
            <!-- Tool Icon & Meta -->
            <div class="tool-hero-header">
                <div class="tool-hero-icon">
                    ü§ñ
                </div>
                <div class="tool-hero-meta">
                    <div class="tool-category-badge">
                        {% if tool.category %}
                            {{ tool.category|title }} Tool
                        {% else %}
                            AI Tool
                        {% endif %}
                    </div>
                    <h1 class="tool-hero-title">{{ tool.name }}</h1>
                    <div class="tool-hero-stats">
                        <span class="stat-item">‚≠ê Featured</span>
                        <span class="stat-item">üî• Popular</span>
                        <span class="stat-item">‚ú® AI-Powered</span>
                    </div>
                </div>
                <div class="tool-hero-actions">
                    <button class="action-btn" onclick="shareTool()" title="Share Tool">
                        üîó
                    </button>
                    <button class="action-btn" onclick="bookmarkTool()" title="Bookmark">
                        ‚≠ê
                    </button>
                    <button class="action-btn" onclick="copyLink()" title="Copy Link">
                        üìã
                    </button>
                </div>
            </div>

            <!-- Tool Description -->
            <div class="tool-description">
                <p>{{ tool.description }}</p>
            </div>

            <!-- Quick Action Buttons -->
            <div class="tool-quick-actions">
                {% if tool.link %}
                <a href="{{ tool.link }}" target="_blank" class="quick-action-btn primary">
                    üåê Official Website
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                </a>
                {% endif %}
                
                {% if tool.documentation_link %}
                <a href="{{ tool.documentation_link }}" target="_blank" class="quick-action-btn secondary">
                    üìñ Documentation
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- AI Explanation Section -->
<section class="ai-explanation-section">
    <div class="ai-section-header">
        <div class="ai-icon-large">ü§ñ</div>
        <h2>Generate AI Explanation</h2>
        <p>Get a detailed explanation powered by Google's Gemini AI</p>
    </div>

    <!-- AI Query Display -->
    <div class="ai-query-display">
        <div class="query-header">
            <span class="query-label">AI will answer:</span>
        </div>
        <div class="query-text">
            {% if tool.perplexity_query %}
                "{{ tool.perplexity_query }}"
            {% else %}
                "Explain what {{ tool.name }} is and how it works"
            {% endif %}
        </div>
    </div>

    <!-- AI Action Form -->
    <form method="post" class="ai-form" id="ai-explanation-form">
        {% csrf_token %}
        <button type="submit" class="ai-ask-btn" id="ai-ask-button" {% if not tool.perplexity_query %}disabled{% endif %}>
            <span class="btn-content">
                <span class="btn-icon">ü§ñ</span>
                <span class="btn-text">Ask AI</span>
                <span class="btn-sparkle">‚ú®</span>
            </span>
            <span class="btn-loading" style="display: none;">
                <svg class="spinner" width="24" height="24" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none" opacity="0.25"></circle>
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none" stroke-dasharray="31.416" stroke-dashoffset="31.416" opacity="0.75">
                        <animate attributeName="stroke-dasharray" dur="2s" values="0 31.416;15.708 15.708;0 31.416" repeatCount="indefinite"/>
                        <animate attributeName="stroke-dashoffset" dur="2s" values="0;-15.708;-31.416" repeatCount="indefinite"/>
                    </animate>
                </circle>
                </svg>
                <span>AI is thinking...</span>
            </span>
        </button>
        
        {% if not tool.perplexity_query %}
        <p class="query-warning">
            ‚ö†Ô∏è No AI query configured for this tool yet.
        </p>
        {% endif %}
    </form>

    <!-- AI Response Display -->
    {% if explanation %}
    <div class="ai-response-container" id="ai-response">
        <div class="ai-response-header">
            <div class="ai-avatar">ü§ñ</div>
            <div class="ai-response-meta">
                <h3>AI Explanation</h3>
                <span class="response-timestamp">Just now</span>
            </div>
            <div class="response-actions">
                <button class="response-action-btn" onclick="copyResponse()" title="Copy Response">
                    üìã
                </button>
                <button class="response-action-btn" onclick="regenerateResponse()" title="Regenerate">
                    üîÑ
                </button>
            </div>
        </div>
        <div class="ai-response-content">
            {{ explanation|linebreaks }}
        </div>
        <div class="ai-response-footer">
            <span class="response-source">Powered by Google Gemini AI</span>
            <div class="response-rating">
                <span>Was this helpful?</span>
                <button class="rating-btn" onclick="rateResponse(true)">üëç</button>
                <button class="rating-btn" onclick="rateResponse(false)">üëé</button>
            </div>
        </div>
    </div>
    {% endif %}
</section>

<!-- Tool Details Section -->
<section class="tool-details-section">
    <h2>Tool Information</h2>
    <div class="details-grid">
        <div class="detail-card">
            <div class="detail-icon">üè∑Ô∏è</div>
            <h3>Category</h3>
            <p>{{ tool.category|default:"General AI Tool"|title }}</p>
        </div>
        
        <div class="detail-card">
            <div class="detail-icon">üåê</div>
            <h3>Availability</h3>
            <p>
                {% if tool.link %}
                    Online Platform
                {% else %}
                    Coming Soon
                {% endif %}
            </p>
        </div>
        
        <div class="detail-card">
            <div class="detail-icon">üìä</div>
            <h3>AI Type</h3>
            <p>
                {% if "gpt" in tool.name|lower or "language" in tool.description|lower %}
                    Large Language Model
                {% elif "vision" in tool.description|lower or "image" in tool.description|lower %}
                    Computer Vision
                {% elif "audio" in tool.description|lower or "speech" in tool.description|lower %}
                    Audio Processing
                {% else %}
                    Machine Learning
                {% endif %}
            </p>
        </div>
        
        <div class="detail-card">
            <div class="detail-icon">‚ö°</div>
            <h3>Performance</h3>
            <p>High-speed processing</p>
        </div>
    </div>
</section>

<!-- Related Tools Section -->
<section class="related-tools-section">
    <h2>You might also like</h2>
    <div class="related-tools-grid">
        <!-- Placeholder for related tools - can be populated with actual data -->
        <div class="related-tool-card">
            <div class="related-tool-icon">ü§ñ</div>
            <h4>Similar AI Tools</h4>
            <p>Discover more tools in this category</p>
            <a href="{% url 'curator_app:tool_list' %}?category={{ tool.category|default:'general' }}" class="related-tool-link">
                Explore ‚Üí
            </a>
        </div>
        
        <div class="related-tool-card">
            <div class="related-tool-icon">üì∞</div>
            <h4>Latest AI News</h4>
            <p>Stay updated with AI developments</p>
            <a href="{% url 'curator_app:news_list' %}" class="related-tool-link">
                Read News ‚Üí
            </a>
        </div>
    </div>
</section>

<style>
    /* Float animation */
    @keyframes float {
        0%, 100% { transform: translate(0px, 0px) rotate(0deg); }
        33% { transform: translate(30px, -30px) rotate(120deg); }
        66% { transform: translate(-20px, 20px) rotate(240deg); }
    }

    /* Breadcrumb */
    .breadcrumb {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-family: 'Rajdhani', sans-serif;
        font-size: 0.95rem;
    }

    .breadcrumb a {
        color: var(--text-muted);
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .breadcrumb a:hover {
        color: var(--neon-cyan);
    }

    .breadcrumb-sep {
        color: var(--text-muted);
        opacity: 0.6;
    }

    .breadcrumb-current {
        color: var(--text-light);
        font-weight: 600;
    }

    /* Tool Hero Section */
    .tool-hero {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 25px;
        padding: 2.5rem;
        margin-bottom: 3rem;
        position: relative;
        overflow: hidden;
    }

    .tool-hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--neon-purple), var(--neon-cyan), var(--light-purple));
    }

    .tool-hero-header {
        display: flex;
        align-items: flex-start;
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .tool-hero-icon {
        width: 4rem;
        height: 4rem;
        border-radius: 50%;
        background: linear-gradient(45deg, var(--neon-purple), var(--neon-cyan));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        box-shadow: 0 0 30px rgba(191, 0, 255, 0.5);
        flex-shrink: 0;
    }

    .tool-hero-meta {
        flex: 1;
    }

    .tool-category-badge {
        background: linear-gradient(45deg, var(--neon-purple), var(--light-purple));
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 15px;
        font-size: 0.9rem;
        font-weight: bold;
        display: inline-block;
        margin-bottom: 1rem;
    }

    .tool-hero-title {
        font-family: 'Orbitron', monospace;
        font-size: 2.5rem;
        font-weight: 900;
        background: linear-gradient(45deg, var(--text-light), var(--neon-cyan));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        line-height: 1.2;
    }

    .tool-hero-stats {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .stat-item {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
        color: var(--text-muted);
        font-family: 'Rajdhani', sans-serif;
    }

    .tool-hero-actions {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .action-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        padding: 0.75rem;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.2rem;
        width: 3rem;
        height: 3rem;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .action-btn:hover {
        background: var(--neon-purple);
        color: white;
        transform: scale(1.1);
        box-shadow: 0 0 20px rgba(191, 0, 255, 0.4);
    }

    .tool-description {
        margin-bottom: 2rem;
    }

    .tool-description p {
        font-size: 1.2rem;
        line-height: 1.6;
        color: var(--text-light);
    }

    .tool-quick-actions {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .quick-action-btn {
        background: linear-gradient(45deg, var(--accent-purple), var(--light-purple));
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 20px;
        text-decoration: none;
        font-family: 'Orbitron', monospace;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .quick-action-btn.secondary {
        background: var(--glass-bg);
        border: 2px solid var(--neon-cyan);
        color: var(--neon-cyan);
    }

    .quick-action-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 0 25px rgba(191, 0, 255, 0.4);
        text-shadow: none;
    }

    .quick-action-btn.secondary:hover {
        background: var(--neon-cyan);
        color: var(--primary-dark);
        box-shadow: 0 0 25px rgba(0, 212, 255, 0.4);
    }

    /* AI Explanation Section */
    .ai-explanation-section {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 25px;
        padding: 2.5rem;
        margin-bottom: 3rem;
        text-align: center;
    }

    .ai-section-header {
        margin-bottom: 2rem;
    }

    .ai-icon-large {
        width: 4rem;
        height: 4rem;
        border-radius: 50%;
        background: linear-gradient(45deg, var(--neon-cyan), var(--neon-purple));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        margin: 0 auto 1rem;
        box-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
    }

    .ai-section-header h2 {
        font-family: 'Orbitron', monospace;
        font-size: 2rem;
        background: linear-gradient(45deg, var(--neon-cyan), var(--neon-purple));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
    }

    .ai-section-header p {
        color: var(--text-muted);
        font-size: 1.1rem;
    }

    .ai-query-display {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 1.5rem;
        margin-bottom: 2rem;
        text-align: left;
    }

    .query-header {
        margin-bottom: 1rem;
    }

    .query-label {
        background: var(--neon-cyan);
        color: var(--primary-dark);
        padding: 0.25rem 0.75rem;
        border-radius: 10px;
        font-size: 0.85rem;
        font-weight: bold;
        font-family: 'Orbitron', monospace;
    }

    .query-text {
        font-size: 1.2rem;
        color: var(--text-light);
        font-style: italic;
        line-height: 1.5;
    }

    .ai-ask-btn {
        background: linear-gradient(45deg, var(--neon-purple), var(--neon-cyan));
        border: none;
        border-radius: 25px;
        padding: 1.5rem 3rem;
        color: white;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(191, 0, 255, 0.3);
        margin-bottom: 1rem;
    }

    .ai-ask-btn:not(:disabled):hover {
        transform: scale(1.05);
        box-shadow: 0 15px 40px rgba(191, 0, 255, 0.5);
    }

    .ai-ask-btn:disabled {
        background: var(--glass-bg);
        color: var(--text-muted);
        cursor: not-allowed;
        box-shadow: none;
    }

    .btn-content {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-sparkle {
        animation: sparkle 2s ease-in-out infinite;
    }

    @keyframes sparkle {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.5; transform: scale(1.2); }
    }

    .query-warning {
        color: #ff6b6b;
        font-size: 0.95rem;
        margin-top: 1rem;
    }

    /* AI Response */
    .ai-response-container {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        border: 2px solid var(--neon-cyan);
        border-radius: 20px;
        padding: 2rem;
        margin-top: 2rem;
        text-align: left;
        animation: slideUp 0.6s ease-out;
        box-shadow: 0 0 30px rgba(0, 212, 255, 0.2);
    }

    @keyframes slideUp {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .ai-response-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--glass-border);
    }

    .ai-avatar {
        width: 3rem;
        height: 3rem;
        border-radius: 50%;
        background: linear-gradient(45deg, var(--neon-cyan), var(--neon-purple));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
    }

    .ai-response-meta {
        flex: 1;
    }

    .ai-response-meta h3 {
        color: var(--text-light);
        font-family: 'Orbitron', monospace;
        margin-bottom: 0.25rem;
    }

    .response-timestamp {
        color: var(--text-muted);
        font-size: 0.9rem;
    }

    .response-actions {
        display: flex;
        gap: 0.5rem;
    }

    .response-action-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        border-radius: 8px;
        padding: 0.5rem;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
    }

    .response-action-btn:hover {
        background: var(--neon-cyan);
        color: var(--primary-dark);
    }

    .ai-response-content {
        color: var(--text-light);
        line-height: 1.7;
        font-size: 1.1rem;
        margin-bottom: 1.5rem;
    }

    .ai-response-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 1rem;
        border-top: 1px solid var(--glass-border);
        flex-wrap: wrap;
        gap: 1rem;
    }

    .response-source {
        color: var(--text-muted);
        font-size: 0.9rem;
        font-style: italic;
    }

    .response-rating {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-muted);
        font-size: 0.9rem;
    }

    .rating-btn {
        background: none;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .rating-btn:hover {
        transform: scale(1.2);
    }

    /* Tool Details Section */
    .tool-details-section {
        margin-bottom: 3rem;
    }

    .tool-details-section h2 {
        font-family: 'Orbitron', monospace;
        font-size: 2rem;
        color: var(--light-purple);
        margin-bottom: 2rem;
        text-align: center;
    }

    .details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .detail-card {
        background: var(--glass-bg);
        backdrop-filter: blur(15px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s ease;
    }

    .detail-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(139, 92, 246, 0.2);
        border-color: var(--light-purple);
    }

    .detail-icon {
        font-size: 2rem;
        margin-bottom: 1rem;
    }

    .detail-card h3 {
        color: var(--light-purple);
        font-family: 'Orbitron', monospace;
        margin-bottom: 0.5rem;
    }

    .detail-card p {
        color: var(--text-muted);
    }

    /* Related Tools Section */
    .related-tools-section {
        margin-bottom: 3rem;
    }

    .related-tools-section h2 {
        font-family: 'Orbitron', monospace;
        font-size: 2rem;
        color: var(--light-purple);
        margin-bottom: 2rem;
        text-align: center;
    }

    .related-tools-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
    }

    .related-tool-card {
        background: var(--glass-bg);
        backdrop-filter: blur(15px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 2rem;
        text-align: center;
        transition: all 0.3s ease;
    }

    .related-tool-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 212, 255, 0.2);
        border-color: var(--neon-cyan);
    }

    .related-tool-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }

    .related-tool-card h4 {
        color: var(--text-light);
        font-family: 'Orbitron', monospace;
        margin-bottom: 1rem;
    }

    .related-tool-card p {
        color: var(--text-muted);
        margin-bottom: 1.5rem;
    }

    .related-tool-link {
        background: linear-gradient(45deg, var(--neon-cyan), var(--light-purple));
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 15px;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
        display: inline-block;
    }

    .related-tool-link:hover {
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(0, 212, 255, 0.4);
        text-shadow: none;
    }

    .spinner {
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .tool-hero-header {
            flex-direction: column;
            text-align: center;
            gap: 1.5rem;
        }

        .tool-hero-actions {
            flex-direction: row;
            justify-content: center;
        }

        .tool-hero-title {
            font-size: 2rem;
        }

        .tool-quick-actions {
            justify-content: center;
        }

        .details-grid {
            grid-template-columns: 1fr;
        }

        .related-tools-grid {
            grid-template-columns: 1fr;
        }

        .ai-response-footer {
            flex-direction: column;
            text-align: center;
        }

        .breadcrumb {
            flex-wrap: wrap;
        }
    }
</style>

<script>
    // Share tool function
    function shareTool() {
        if (navigator.share) {
            navigator.share({
                title: '{{ tool.name }} - AI Curator',
                text: '{{ tool.description|truncatechars:100 }}',
                url: window.location.href
            });
        } else {
            navigator.clipboard.writeText(window.location.href).then(() => {
                alert('Tool link copied to clipboard!');
            });
        }
    }

    // Bookmark tool function
    function bookmarkTool() {
        console.log('Bookmarked tool: {{ tool.name }}');
        alert('{{ tool.name }} bookmarked! (Feature coming soon)');
    }

    // Copy link function
    function copyLink() {
        navigator.clipboard.writeText(window.location.href).then(() => {
            alert('Link copied to clipboard!');
        });
    }

    // Copy AI response function
    function copyResponse() {
        const responseText = document.querySelector('.ai-response-content').innerText;
        navigator.clipboard.writeText(responseText).then(() => {
            alert('AI response copied to clipboard!');
        });
    }

    // Regenerate response function
    function regenerateResponse() {
        const form = document.getElementById('ai-explanation-form');
        const submitBtn = document.getElementById('ai-ask-button');
        
        // Show loading state
        const btnContent = submitBtn.querySelector('.btn-content');
        const btnLoading = submitBtn.querySelector('.btn-loading');
        
        btnContent.style.display = 'none';
        btnLoading.style.display = 'flex';
        submitBtn.disabled = true;
        
        // Submit form
        form.submit();
    }

    // Rate response function
    function rateResponse(isPositive) {
        const rating = isPositive ? 'positive' : 'negative';
        console.log('Response rated:', rating);
        alert(`Thanks for your ${rating} feedback!`);
        
        // Update button styles to show selection
        const ratingBtns = document.querySelectorAll('.rating-btn');
        ratingBtns.forEach(btn => btn.style.opacity = '0.5');
        event.target.style.opacity = '1';
        event.target.style.transform = 'scale(1.3)';
    }

    // Form submission handling
    document.getElementById('ai-explanation-form').addEventListener('submit', function(e) {
        const submitBtn = document.getElementById('ai-ask-button');
        const btnContent = submitBtn.querySelector('.btn-content');
        const btnLoading = submitBtn.querySelector('.btn-loading');
        
        // Show loading state
        btnContent.style.display = 'none';
        btnLoading.style.display = 'flex';
        submitBtn.disabled = true;
        
        // Scroll to response area after form submission
        setTimeout(() => {
            const responseArea = document.getElementById('ai-response');
            if (responseArea) {
                responseArea.scrollIntoView({ behavior: 'smooth' });
            }
        }, 500);
    });

    // Add sparkle animation to floating elements
    document.addEventListener('DOMContentLoaded', function() {
        // Add some interactive sparkle effects
        const sparkleElements = document.querySelectorAll('.btn-sparkle');
        sparkleElements.forEach(el => {
            setInterval(() => {
                el.style.textShadow = '0 0 10px #00d4ff';
                setTimeout(() => {
                    el.style.textShadow = 'none';
                }, 200);
            }, 3000);
        });
    });
</script>

{% endblock %}